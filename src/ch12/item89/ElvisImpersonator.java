package ch12.item89;

import ch12.serializeTest.Serializer;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.ObjectInputStream;

public class ElvisImpersonator {
  // Elvis 인스턴스를 복제하는 데 사용할 직렬화된 바이트 스트림
  private static final byte[] serializedForm = {
      (byte) 0xac, (byte) 0xed, 0x00, 0x05,  // 스트림 헤더
      0x73, 0x72, 0x00, 0x11,  // 클래스 시작
      0x63, 0x68, 0x31, 0x32, 0x2e, 0x69, 0x74, 0x65,
      0x6d, 0x38, 0x39, 0x2e, 0x45, 0x6c, 0x76, 0x69,
      0x73, (byte) 0xfd, (byte) 0xb1,  // 클래스 이름
      0x76, (byte) 0xe6, (byte) 0x99, (byte) 0x8a, 0x45, (byte) 0xdb, 0x02,
      0x00, 0x01,  // 필드 개수
      0x5b, 0x00, 0x0e,  // 배열 필드 타입
      0x66, 0x61, 0x76, 0x6f, 0x72, 0x69, 0x74, 0x65,
      0x53, 0x6f, 0x6e, 0x67, 0x73, 0x74, 0x00, 0x02,
      0x5b, 0x4c, 0x00, 0x0c,  // 필드 이름
      0x6a, 0x61, 0x76, 0x61, 0x2e, 0x6c, 0x61, 0x6e,
      0x67, 0x2e, 0x53, 0x74, 0x72, 0x69, 0x6e, 0x67,
      0x3b, (byte) 0x90, 0x78,  // 배열 값 시작
      0x75, 0x72, 0x00, 0x02,  // 배열의 타입 설명
      0x5b, 0x4c, 0x00, 0x12,
      0x00, 0x02, 0x74, 0x00,  // 값들 (임의 값)
      0x09, 0x48, 0x6f, 0x75, 0x6e, 0x64, 0x20,
      0x44, 0x6f, 0x67, 0x74, 0x00, 0x0f
  };


  // 직렬화된 바이트 스트림을 역직렬화하여 객체 생성

  public static void main(String[] args){
    Serializer serializer = new Serializer();
    Elvis elvis = (Elvis) serializer.deserialize(serializedForm);
    Elvis impersonator = ElvisStealer.impersonator;

    elvis.printFavorites();
    impersonator.printFavorites();
  }
}
